#!/bin/bash

# Update package list and install UFW
sudo apt update
sudo apt install ufw -y

# Set default policies
sudo ufw default deny incoming
sudo ufw default allow outgoing

# Allow necessary ports
sudo ufw allow 22/tcp  # SSH
sudo ufw allow 80/tcp  # HTTP
sudo ufw allow 443/tcp # HTTPS

# Enable UFW
sudo ufw enable

# Display UFW status to verify rules
sudo ufw status verbose

# Check UFW service status
sudo systemctl status ufw

# Test connectivity (optional)
echo "Testing SSH connectivity..."
ssh -o ConnectTimeout=5 ubuntu@44.201.240.217 echo "SSH connection successful."

echo "Testing HTTP connectivity..."
curl -I http://44.201.240.217

echo "Testing HTTPS connectivity..."
curl -I https://44.201.240.217
